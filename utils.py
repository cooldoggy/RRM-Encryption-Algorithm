def meshmaker(inputstring):
    return [list(inputstring[i*8:(i+1)*8]) for i in range(8)]

def xorutil(a, b):
    return a ^ b

def substitutionboxencrypt(a, b):
    encrypttable = [
        ["97", "96", "42", "20", "36", "78", "16", "63", "11", "08"],
        ["13", "30", "68", "09", "95", "89", "05", "99", "65", "35"],
        ["01", "44", "72", "46", "04", "71", "02", "22", "29", "90"],
        ["61", "81", "62", "21", "34", "32", "73", "53", "45", "80"],
        ["98", "49", "93", "41", "60", "64", "70", "47", "40", "69"],
        ["87", "54", "24", "84", "18", "77", "66", "26", "38", "85"],
        ["59", "43", "48", "91", "92", "00", "14", "58", "03", "75"],
        ["28", "67", "17", "15", "83", "12", "94", "23", "39", "86"],
        ["52", "27", "37", "88", "82", "51", "06", "55", "10", "33"],
        ["57", "07", "76", "50", "56", "31", "25", "74", "19", "79"]
    ]
    return encrypttable[a][b]

def esbox(inputstring):
    temp = ""
    out = ""
    for i in inputstring:
        temp += i
        if len(temp) == 2:
            a = int(temp[0], 16) % 10
            b = int(temp[1], 16) % 10
            out += substitutionboxencrypt(a, b)
            temp = ""
    return out